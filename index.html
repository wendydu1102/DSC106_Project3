<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sunny Cloudy San Diego</title>
    <script src="https://unpkg.com/d3@7"></script>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="page">
        <header>
            <span class="title-badge">CMIP6 ‚Ä¢ Amon Table</span>
            <h1><span style="text-decoration: line-through;">Sunny</span> Cloudy SoCal</h1>
            <p>Comparing historical coastal cloudiness to a high-emissions future to explore how total cloud fraction might shift along Southern California's shoreline.</p>
        </header>

        <div class="controls-panel">
            <div class="control-group">
                <label for="scenarioFilter">Scenario visibility</label>
                <select id="scenarioFilter">
                    <option value="both">Show both scenarios</option>
                    <option value="historical">Historical only</option>
                    <option value="future">Future only</option>
                </select>
            </div>
            <div class="control-group">
                <label for="yearSlider">Highlight year</label>
                <input type="range" id="yearSlider" min="1850" max="2100" value="2000" step="1" />
                </div>
            <div class="control-group">
                <label>Current focus</label>
                <div class="year-readout" id="yearReadout">Year 2000</div>
                <div class="year-context" id="yearContext"></div>
            </div>
        </div>

        <section id="trendSection">
            <h2>Total cloud fraction across time</h2>
            <p class="section-intro">Total cloud fraction inside the Southern California marine layer box (30¬∞‚Äì35¬∞N, 125¬∞‚Äì115¬∞W) using ACCESS-CM2 historical vs. future runs.</p>
            <div class="view-controls" style="margin-bottom: 15px;">
                <div style="display: flex; gap: 10px; flex-wrap: wrap; align-items: center;">
                    <label style="font-size: 12px; font-weight: 600; color: var(--muted);">View mode:</label>
                    <button type="button" class="view-toggle active" data-view="annual">Annual</button>
                    <button type="button" class="view-toggle" data-view="seasonal">Seasonal</button>
                    <span id="viewModeHint" style="font-size: 11px; color: var(--muted); margin-left: auto;">Click and drag on the chart to zoom into monthly detail</span>
                </div>
                <div style="display: flex; justify-content: flex-end; margin-top: 8px;">
                    <button type="button" class="back-btn" id="resetZoomBtn" style="display: none;">‚Üê Reset zoom (show annual view)</button>
                </div>
            </div>
            <div class="chart-frame" id="trendChart"></div>
            <div class="legend" id="trendLegend"></div>
            <div id="legendHint" style="display: none; margin-top: 12px; font-size: 13px; color: var(--muted); font-style: italic;">
                üí° Click legend items above to show or hide specific seasonal lines for comparison
            </div>
        </section>

        <section id="writeupSection">
            <div class="writeup-header" id="writeupToggle">
                <h2>Design & Development Process</h2>
                <span class="toggle-icon" id="writeupToggleIcon">‚ñº</span>
            </div>
            <div class="writeup-content" id="writeupContent" style="display: none;">
                
                <div class="writeup-subsection">
                    <h3>Motivation & Question</h3>
                    <p>As UCSD students, we always hear that it never rains in San Diego and that the sunny beaches are basically our 
                        default weather forecast. Because of that, it can be hard to tell how much cloud coverage we actually get, 
                        beyond the occasional marine layer drifting in on the way to morning classes. The CMIP6 Amon table contains 
                        a huge and complex collection of climate model outputs, and we wanted to use it to move beyond vibes and 
                        actually measure cloudiness in coastal Southern California. The dataset is rich but difficult to interpret 
                        without visualization, so creating an interactive dashboard became essential. This led us to our central 
                        question: <strong>What is the chance of cloud coverage in coastal Southern California, and how does it change 
                            from historical conditions to future high-emissions projections?</strong> Our visualization helps turn 
                            this overwhelming dataset into something interactive, clear, and genuinely useful.</p>
                </div>

                <div class="writeup-subsection">
                    <h3>Design Rationale</h3>
                    <p>Our visualization design emphasizes clarity and interactive exploration of climate data. We chose line charts as the primary encoding because they effectively show temporal trends and allow easy comparison between historical and future scenarios.</p>
                    <p><strong>Visual Encodings:</strong></p>
                    <ul>
                        <li><strong>Line charts</strong> for temporal trends: We selected line charts to display annual, seasonal, and monthly cloud fraction data because they clearly communicate trends over time and enable direct comparison between scenarios.</li>
                        <li><strong>Color palette</strong>: We used a color-blind safe palette with dark navy (#314d64) for historical data and teal (#2a9d8f) for future projections. For seasonal views, we assigned distinct colors to each season (DJF: dark blue-green, MAM: teal, JJA: golden, SON: orange) to help users distinguish patterns.</li>
                        <li><strong>Brush/zoom interaction</strong>: We implemented a brush chart to enable users to zoom into specific time ranges and explore monthly detail. This provides both an overview (annual data) and detailed exploration (monthly data) in a single interface.</li>
                        <li><strong>Multiple view modes</strong>: We added toggle buttons for "Annual" and "Seasonal" views to let users switch between aggregated and seasonal perspectives without cluttering the interface.</li>
            </ul>
                    <p><strong>Interaction Techniques:</strong></p>
                    <ul>
                        <li><strong>Year slider</strong>: Allows users to highlight specific years across all visualizations, creating a synchronized exploration experience.</li>
                        <li><strong>Scenario filter</strong>: Enables users to focus on historical, future, or both scenarios, with automatic x-axis adjustment to show only relevant time periods.</li>
                        <li><strong>Hover tooltips</strong>: Provide detailed information (year, scenario, cloud fraction, season/month) on demand without cluttering the main view.</li>
                        <li><strong>Brush selection</strong>: Users can select time ranges in the brush chart to zoom into monthly detail in the main chart, enabling drill-down exploration.</li>
            </ul>
                    <p><strong>Design Alternatives Considered:</strong></p>
                    <ul>
                        <li>We considered using area charts instead of line charts but decided lines were cleaner and better for comparing multiple series.</li>
                        <li>We explored stacked bar charts for seasonal comparison but chose overlay line charts for better temporal trend visualization.</li>
                        <li>We initially considered separate pages for different views but opted for a single-page design with toggleable sections to maintain context.</li>
            </ul>
                </div>

                <div class="writeup-subsection">
            <h3>Development Process</h3>
                    <p><strong>Team Collaboration:</strong></p>
                    <p>The development process was collaborative with team members working on different aspects:</p>
                    <ul>
                        <li><strong>Data Processing</strong>: One team member focused on processing CMIP6 climate data from Zarr files, extracting the Southern California coastal region, and generating CSV files for annual, seasonal, and monthly aggregates.</li>
                        <li><strong>Visualization Design</strong>: Team members worked together on designing the layout, selecting color schemes, and planning the interaction flow.</li>
                        <li><strong>D3.js Implementation</strong>: The visualization code was developed iteratively, with team members implementing different chart components (trend chart, map, seasonal cards) and integrating them into a cohesive dashboard.</li>
                        <li><strong>Testing & Refinement</strong>: The team collectively tested the visualization, refined interactions, and ensured data accuracy across all views.</li>
            </ul>
                    <p><strong>Development Timeline:</strong></p>
                    <p>Total development time: Approximately <strong>40-50 people-hours</strong> spread across team members.</p>
                    <p><strong>Time Distribution:</strong></p>
                    <ul>
                        <li><strong>Data Processing (15-20 hours)</strong>: Extracting and processing CMIP6 data, handling non-standard calendars (cftime), computing temporal aggregates, and debugging data inconsistencies took the most time.</li>
                        <li><strong>Initial Visualization Setup (8-10 hours)</strong>: Setting up the D3.js infrastructure, creating basic line charts, implementing data loading, and establishing the overall layout.</li>
                        <li><strong>Interactive Features (10-12 hours)</strong>: Implementing the brush/zoom functionality, year slider synchronization, scenario filtering, and tooltip interactions required careful coordination between different components.</li>
                        <li><strong>Seasonal View & Monthly Detail (5-6 hours)</strong>: Adding the seasonal view mode, computing seasonal data from monthly aggregates, and implementing the zoom-to-monthly-detail feature.</li>
                        <li><strong>Polishing & Debugging (5-7 hours)</strong>: Refining styles, fixing edge cases (like scenario filter affecting x-axis domains), ensuring responsive design, and testing across different browsers.</li>
            </ul>
                    <p><strong>Challenges Encountered:</strong></p>
                    <ul>
                        <li>Handling cftime objects in xarray when converting to pandas DataFrames required special attention to date extraction.</li>
                        <li>Coordinating the x-axis domain updates when scenario filters changed across different view modes (annual, seasonal, monthly) was complex.</li>
                        <li>Implementing smooth transitions between view modes while maintaining state (zoom level, selected year) required careful state management.</li>
                        <li>Ensuring the brush chart and main chart stayed synchronized when scenario filters changed.</li>
            </ul>
        </div>
            </div>
        </section>

        <section id="mapSection">
            <div class="writeup-header" id="mapToggle">
                <h2>Study region</h2>
                <span class="toggle-icon" id="mapToggleIcon">‚ñº</span>
            </div>
            <div class="writeup-content" id="mapContent" style="display: none;">
                <p class="section-intro">The analysis focuses on the Southern California coastal marine layer box (30¬∞‚Äì35¬∞N, 125¬∞‚Äì115¬∞W) where June Gloom and coastal cloud patterns occur.</p>
                <div class="chart-frame" id="mapChart"></div>
                <p class="context-note">Study area: 30¬∞‚Äì35¬∞N latitude, 125¬∞‚Äì115¬∞W longitude (235¬∞‚Äì245¬∞E), encompassing the Southern California coast from the Mexican border to central California.</p>
            </div>
        </section>
    </div>

    <div class="tooltip" id="tooltip"></div>

    <script src="script.js"></script>
</body>
</html>
